<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:c="http://java.sun.com/jsp/jstl/core">


<ui:composition template="/template/mylayout.xhtml">
	<ui:param name="activeIndex" value="1" />
	<ui:define name="content">
		<h:form id="tableForm">
			<div class="ui-g">

				<div class="ui-g-3">
					<p:commandButton value="Ajout maquette"
						rendered="#{personController.isAdmin()}"
						onclick="PF('addModelDialog').show();">
					</p:commandButton>
				</div>
			</div>
			<div class="ui-g-12">
				<p:dataTable id="models" var="model" value="#{modelView.models}"
					rows="6" paginator="true" lazy="true" paginatorPosition="both"
					paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
					rowsPerPageTemplate="6, 12, 16, 32">

					<p:column headerText="Responsables">
						<p:dataList value="#{modelView.findResponsibles(model.code)}"
							var="responsible">
							<h:outputText value="#{responsible.name}" />
						</p:dataList>
					</p:column>
					<p:column headerText="Codes">
						<h:outputText value="#{model.code} " />
					</p:column>

					<p:column headerText="Noms">
						<h:commandLink value="#{model.name}"
							action="#{modelView.showModel(model.code)}" />
					</p:column>
					<p:column rendered="#{personController.isAdmin()}">
						<p:commandButton icon="fa fa-pencil"
							action="#{modelView.initEdit(model)}" update="editModelForm"
							onclick="PF('editModelDialog').show();" />
						<p:commandButton icon="fa fa-times"
							action="#{modelView.removeModel(model.code, personController.user)}" update="models"/>
					</p:column>
				</p:dataTable>
			</div>
		</h:form>

		<p:dialog header="Modifier maquette" widgetVar="editModelDialog"
			modal="true" resizable="false" responsive="true" draggable="false"
			width="50%">
			<h:form id="editModelForm">
				<p:panelGrid columns="3" layout="grid"
					columnClasses="ui-grid-col-3, ui-grid-col-6, ui-grid-col-3">

					<h:outputText value="Nom : " />
					<p:inputText type="text" value="#{modelView.theModel.name}"
						styleClass="form-control" id="inputName" placeholder="Nom"
						required="true" requiredMessage="Nom requis" />
					<p:message for="inputName" showDetail="false" display="icon" />


					<h:outputText value="Code :" />
					<p:inputText type="text" value="#{modelView.theModel.code}"
						styleClass="form-control" id="inputCode" placeholder="Code"
						required="true" requiredMessage="Code requis" disabled="true" />
					<p:message for="inputCode" showDetail="false" display="icon">
						<p:autoUpdate />
					</p:message>

					<h:outputText value="Responsable :" />
					<h:panelGrid columns="2" style="margin-bottom:10px" cellpadding="5">
						<p:outputLabel for="responsable" value="" />
						<p:selectCheckboxMenu id="responsable"
							value="#{modelView.responsiblesEdit}" required="true"
							requiredMessage="Responsable requis">
							<f:selectItems value="#{personController.findAllPersons()}" />
						</p:selectCheckboxMenu>
					</h:panelGrid>
					<p:message for="responsable" display="both">
						<p:autoUpdate />
					</p:message>
					<p:commandButton value="Valider"
						action="#{modelView.editModel(personController.user)}"
						update="tableForm:models" icon="fa fa-check" />
				</p:panelGrid>
			</h:form>
		</p:dialog>

		<p:dialog header="Ajout maquette" widgetVar="addModelDialog"
			modal="true" resizable="false" responsive="true" draggable="false"
			width="50%">

			<h:form id="addModelForm">
				<p:panelGrid columns="3" layout="grid"
					columnClasses="ui-grid-col-3, ui-grid-col-6, ui-grid-col-3">

					<h:outputText value="Nom : " />
					<p:inputText type="text" value="#{modelView.newModel.name}"
						styleClass="form-control" id="inputName" placeholder="Nom"
						required="true" requiredMessage="Nom requis" />
					<p:message for="inputName" display="both">
						<p:autoUpdate />
					</p:message>


					<h:outputText value="Code :" />
					<p:inputText type="text" value="#{modelView.newModel.code}"
						styleClass="form-control" id="inputCode" placeholder="Code"
						required="true" requiredMessage="Code requis" />
					<p:message for="inputCode" display="both">
						<p:autoUpdate />
					</p:message>

					<p:outputLabel for="responsable" value="Responsable :" />
					<p:selectCheckboxMenu id="responsable"
						value="#{modelView.responsibles}" required="true"
						requiredMessage="Responsable requis">
						<f:selectItems value="#{personController.findAllPersons()}" />
					</p:selectCheckboxMenu>
					<p:message for="responsable" display="both">
						<p:autoUpdate />
					</p:message>
					<p:commandButton value="Valider" icon="fa fa-check"
						update="addModelForm tableForm:models"
						action="#{modelView.createModel(personController.user)}" />
				</p:panelGrid>
			</h:form>
		</p:dialog>
	</ui:define>
	<ui:define name="title">Decofo</ui:define>
</ui:composition>
</html>

